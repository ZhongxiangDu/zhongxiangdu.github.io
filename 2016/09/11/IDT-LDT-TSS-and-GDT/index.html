<!DOCTYPE html>
<html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

  <link rel="icon" href="/favicon.ico">
  
  <title>Du&#39;s Blog | IDT LDT TSS and GDT</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/lib/fancybox/jquery.fancybox-1.3.4.css">
  <!--在这里倒入jquery 方便处理部分页面的jquery-->
  <script src="https://cdn.staticfile.org/jquery/1.7/jquery.min.js" type="text/javascript" ></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body>
	<!-- hexo-inject:begin --><!-- hexo-inject:end --><header class="site-header navfixed-false">
  <div class="container">
      <h1><a href="/" title="Du&#39;s Blog"><span class="octicon octicon-bookmark"></span> Du&#39;s Blog</a></h1>
      <nav class="site-header-nav" role="navigation">
        
              
              <a href="/"  class=" site-header-nav-item hvr-underline-from-center" title="Home">Home</a>
        
              
              <a href="/categories/"  class=" site-header-nav-item hvr-underline-from-center" title="Categories">Categories</a>
        
              
              <a href="/open-source/"  class=" site-header-nav-item hvr-underline-from-center" title="Projects">Projects</a>
        
              
              <a href="/about/"  class=" site-header-nav-item hvr-underline-from-center" title="About">About</a>
        
      </nav>
  </div>
</header>

	
<section class="collection-head geopattern" data-pattern-id="IDT LDT TSS and GDT" >
    <div class="container">
        <div class="collection-title">
            <h1 class="collection-header">
                IDT LDT TSS and GDT
            </h1>
            
                <div class="collection-info">
                    <span class="meta-info">
                        <span class="octicon octicon-calendar"></span>
                        <time datetime="2016-09-11T22:36:23.000Z" itemprop="datePublished">2016-09-11</time>
                    </span>
                    
                        <span class="meta-info">
                            <span class="octicon octicon-file-directory"></span>
                            <a href='/categories/Operation-System/' title=''>Operation System</a>
                        </span>
                    
                </div>
            
        </div>
    </div>
</section>
	<section class="container">
    <div class="columns">
        <!-- -->
        <div class="column three-fourths">
            <article class="article-content markdown-body">
                <p>In Linux, there are many similar concepts. This article briefly talks about the IDT (Interrupt Descriptor Table), GDT (Global Descriptor Table), LDT (Local Descriptor Table) and TSS(Task State Segment).<a id="more"></a></p>
<h2 id="IDT-Interrupt-Descriptor-Table"><a href="#IDT-Interrupt-Descriptor-Table" class="headerlink" title="IDT (Interrupt Descriptor Table)"></a>IDT (Interrupt Descriptor Table)</h2><p>The whole system has only one IDT. In protected mode, IDT stores the address of all the ISR (Interrupt Service Routine). When interrupt happens, the system will directly find the corresponding ISR, with the help of IDT. It has similar function compared to the IVT (Interrupt Vector Table) in real mode. Their differences are that IVT has a fixed address but IDT’s address is stored in IDTR (Interrupt Descriptor Table Register) and it can be changed. Using the command,</p>
<pre><code>lidt [idt_48]
</code></pre><p>we can write the address of IDT into IDTR. In IDT, there are many Interrupt Gate, each Interrupt Gate corresponds to a ISR. The structure of Interrupt Gate is shown below.</p>
<center><img align="center" src="/images/InterruptGate.svg"></center>

<h2 id="GDT-Global-Descriptor-Table"><a href="#GDT-Global-Descriptor-Table" class="headerlink" title="GDT (Global Descriptor Table)"></a>GDT (Global Descriptor Table)</h2><p>In the system, there is only one GDT. GDT stores the LDT and TSS of all the processes. We can treat it as a directory of processes. Like IDT, GDT can also be placed in any place of the memory and its address is stored in GDTR (Global Descriptor Table Register). Using the command,</p>
<pre><code>lgdt [gdt_48]
</code></pre><p>we can write the address of GDT into GDTR. The structure of GDT is shown below.</p>
<center><img align="center" src="/images/GlobalDescriptorTable.svg"></center>


<h2 id="LDT-Local-Descriptor-Table"><a href="#LDT-Local-Descriptor-Table" class="headerlink" title="LDT (Local Descriptor Table)"></a>LDT (Local Descriptor Table)</h2><p>In fact, LDT is a segment descriptor and it is used to locate the segment of corresponding process. Every process has a LDT and all the LDTs are stroed in GDT. Because there are many LDTs in the system, we need a selector to choose the current LDT. This selector is LDTR (Local Descriptor Table Register).</p>
<p>While the system is running, all the processes will alternate use the CPU. So the value in LDTR will keep changing all the time. While process switching, we use the “lldt” command to load a new segment. Some other commands can also modify the value in LDTR, for example, “jmpi”.(When Linux 0.11 entering the protected mode, the first used command is “jmpi”)</p>
<h2 id="TSS-Task-State-Segment"><a href="#TSS-Task-State-Segment" class="headerlink" title="TSS (Task State Segment)"></a>TSS (Task State Segment)</h2><p>Each process has its own TSS, its address is stored in a segment descriptor next to LDT in GDT. TSS contains many register informations about current process and it is used to save and recover the context information.</p>
<p>In Linux 0.11, a “ljmp” command to switch the context information (this command has done many other works). “ljmp” command will put all the registers’ information into the TSS of current process, then load the register information in TSS of nest process to all the registers. At the same time, this command will change the value in LDTR, to make it point to the new sgement. </p>
<p>The structure of TSS is hown below. </p>
<center><img align="center" src="/images/TaskStateSegment.svg"></center>
            </article>
            
                <div class="share">
                    <!--开启分享-->
<div class="share-component" data-disabled="google,twitter,facebook" data-description="In Linux, there are many si..."></div>

<script src="/js/share.min.js"></script>

                </div>    
            
            
                
<div class="comments">
	<div class="ds-thread" data-thread-key="IDT-LDT-TSS-and-GDT" data-title="IDT LDT TSS and GDT" data-url="http://www.duzhongxiang.com/2016/09/11/IDT-LDT-TSS-and-GDT/"></div>
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"Zhongxiang Du"};
		(function() {
			var ds = document.createElement('script');
			ds.type = 'text/javascript';ds.async = true;
			ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
			ds.charset = 'UTF-8';
			(document.getElementsByTagName('head')[0]
			 || document.getElementsByTagName('body')[0]).appendChild(ds);
		})();
	</script>
</div>

            
        </div>
        <div class="column one-fourth">
            
                
                


<h3>Post Directory</h3>

<div id="post-directory-module">
	<section class="post-directory">
		<p><strong class="toc-title">Directory</strong></p>
		<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#IDT-Interrupt-Descriptor-Table"><span class="toc-text">IDT (Interrupt Descriptor Table)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GDT-Global-Descriptor-Table"><span class="toc-text">GDT (Global Descriptor Table)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LDT-Local-Descriptor-Table"><span class="toc-text">LDT (Local Descriptor Table)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TSS-Task-State-Segment"><span class="toc-text">TSS (Task State Segment)</span></a></li></ol>
	</section>
</div>

            
        </div>
    </div>
</section>

<footer class="container">
    <div class="site-footer" role="contentinfo">
        <div class="copyright left mobile-block">
                © 2016
                <span title="ZhongxiangDu">Zhongxiang Du</span>
                <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a>
        </div>

        <ul class="site-footer-links right mobile-hidden">
            <li>
                <a href="javascript:window.scrollTo(0,0)" >TOP</a>
            </li>
        </ul>

        <!-- a href="https://github.com/" target="_blank" aria-label="view source code">
            <span class="mega-octicon octicon-mark-github" title="GitHub"></span>
        </a-->

        <ul class="site-footer-links mobile-hidden">
            
                  
                  <li>
                    <a href="/"  title="Home">Home</a>
                  </li>
            
                  
                  <li>
                    <a href="/categories/"  title="Categories">Categories</a>
                  </li>
            
                  
                  <li>
                    <a href="/open-source/"  title="Projects">Projects</a>
                  </li>
            
                  
                  <li>
                    <a href="/about/"  title="About">About</a>
                  </li>
            
            <li>
                <a href="/atom.xml">
                    <span class="octicon octicon-rss" style="color:orange;"></span>
                </a>
            </li>
        </ul>
    </div>
</footer>

		<script src="/js/geopattern.js"></script>
		<script src="/js/highlight.pack.js"></script>
		<script src="/lib/fancybox/jquery.fancybox-1.3.4.pack.js"></script>

		
			<script src="/js/toc.js"></script>
		

		
			<script src="/js/search.js"></script>

			<script type="text/javascript">
				$(function(){
					var currentIndex = -1;
					var search_path = "search.xml";
					if (!search_path) search_path = "search.xml";
					var path = "/" + search_path;
					searchFunc(path, 'search', 'local-search-result');

					$(document).delegate("#local-search-result>.search-result-list li","hover",function(){
						var liNode = $("#local-search-result>.search-result-list li");
						liNode.removeClass("hover");
						currentIndex = $("#local-search-result>.search-result-list li").index($(this));
						liNode.eq(currentIndex).addClass("hover");
					})

					$("#search-form").submit(function(){
						return false;
					})

					$("#search").keydown(function(event){
						var keyCode = event.keyCode;
						var liNode = $("#local-search-result>.search-result-list li");
						if(keyCode == 38 || keyCode == 40 || keyCode == 13){
							liNode.removeClass("hover");
							if(keyCode == 38){
								if(currentIndex - 1 >= 0) currentIndex --;
							}
							if(keyCode == 40){
								if(currentIndex + 1 < liNode.length) currentIndex ++;
							}
							if(keyCode == 13){
								location.href = liNode.eq(currentIndex).find("a").attr("href");
							}
							liNode.eq(currentIndex).addClass("hover");
							return false;
						}else{
							currentIndex = -1;
						}
					})
				})
			</script>
		

		<script src="/js/index.js"></script>

		 <script src="/js/popular_repo.js"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end --> 

	</body>
</html>